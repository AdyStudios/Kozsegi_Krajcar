<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Községi Krajcár Global</title>
        <link rel="icon" type="image/x-icon" href="images\favicon.ico">
    </head>
    <body>
        <div class="cont">
            <h1 id="lab">%%%Name%%% Községi Krajcár egyenlege: <br>%%%Value%%%</h1>
        </div>
    </body>
    <style>
        body {
            background-color: #ff0400;
            
        }
        h1 {
            color: #fff;
            text-align: center;
            font-size: 8rem;
            font-family: "Century Gothic", Courier, monospace;
	        opacity: 1;
	        animation-name: fadeInOpacity;
	        animation-iteration-count: 1;
	        animation-timing-function: ease-in;
	        animation-duration: 0.7s;
        }
        .cont {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 10%;
            box-sizing: content-box;
            border-radius: 8px;
            outline: solid 5px #fff;
        }

        @keyframes fadeInOpacity {
        	0% {
        		opacity: 0;
        	}
        	100% {
        		opacity: 1;
        	}
        }
    </style>
    <script type="text/javascript">
        //TODO: change background color by cr ammount
        const sleep = (milliseconds) => {
            return new Promise(resolve => setTimeout(resolve, milliseconds))
        }
        async function some_shit() {
            //get inner html
            var lab = document.getElementById('lab');
            var inn = lab.innerHTML;
            var spl = inn.split("<br>");
            var frst = spl[0] + "<br>";
            var val = spl[1]; //parseInt("10");
            for (var i = 0; i < 60; i++) {
                document.getElementById('lab').innerHTML = frst + Math.round(val / 60 * i);
                console.log(Math.round(val / 22 * i));
                await sleep(15);
            }
            document.getElementById('lab').innerHTML = inn;
        }
        some_shit();

        const socket = new WebSocket('ws://localhost:8090');
        socket.addEventListener('close',()=>{
            if (!document.URL.includes("/view")) {
                location.reload();
            }
        });
        
    </script>
</html>
